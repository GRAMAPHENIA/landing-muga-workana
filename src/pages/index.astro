---
import '../styles/global.css';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Hero from '../components/Hero.astro';
import Features from '../components/Features.astro';
import Services from '../components/Services.astro';
import About from '../components/About.astro';
import Gallery from '../components/Gallery.astro';
import Testimonials from '../components/Testimonials.astro';
import ContactForm from '../components/ContactForm.astro';
import CTA from '../components/CTA.astro';
import Footer from '../components/Footer.astro';
import { siteConfig } from '../config/site';

// Metadatos optimizados para SEO
const pageMetadata = {
  title: siteConfig.title,
  description: siteConfig.description,
};
---

<BaseLayout {...pageMetadata}>
  <!-- Header fijo -->
  <Header />

  <main>
    <!-- Hero Section con imagen central y credibilidad -->
    <section id="inicio">
      <Hero />
    </section>

    <!-- Beneficios/Características: 3 bloques simples -->
    <section id="beneficios">
      <Features />
    </section>

    <!-- Servicios -->
    <section id="servicios">
      <Services />
    </section>

    <!-- Nosotros -->
    <section id="nosotros">
      <About />
    </section>

    <!-- Galería: grid minimalista con hover sutil -->
    <section id="trabajos">
      <Gallery />
    </section>

    <!-- Testimonios: tarjetas con reseñas breves -->
    <section id="testimonios">
      <Testimonials />
    </section>

    <!-- Contacto -->
    <section id="contacto" class="section bg-neutral-50">
      <div class="container">
        <ContactForm
          title="Solicita tu cotización"
          subtitle="Completa el formulario y te contactaremos para discutir tu proyecto."
          class="max-w-4xl mx-auto"
        />
      </div>
    </section>

    <!-- CTA final: mensaje fuerte y botón de acción -->
    <CTA
      title="¿Listo para comenzar tu proyecto?"
      subtitle="Contacta con nosotros y descubre cómo podemos ayudarte."
      primaryButtonText="Empezar ahora"
      primaryButtonHref="#contacto"
      secondaryButtonText="Ver trabajos"
      secondaryButtonHref="#trabajos"
      background="white"
    />
  </main>

  <!-- Footer simple: links básicos y redes sociales -->
  <Footer />

  <!-- Script para navegación suave y animaciones -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Navegación suave para enlaces con anclas
      const links = document.querySelectorAll('a[href^="#"]');

      links.forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const targetId = link.getAttribute('href')?.substring(1);
          const targetElement = document.getElementById(targetId || '');

          if (targetElement) {
            const headerHeight = 80;
            const targetPosition = targetElement.offsetTop - headerHeight;

            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth',
            });
          }
        });
      });

      // Cerrar menú móvil al hacer scroll
      let lastScrollTop = 0;
      const mobileMenu = document.getElementById('mobile-menu');

      window.addEventListener('scroll', () => {
        const scrollTop = window.scrollY || document.documentElement.scrollTop;

        if (
          scrollTop > lastScrollTop &&
          mobileMenu &&
          !mobileMenu.classList.contains('hidden')
        ) {
          mobileMenu.classList.add('hidden');
        }

        lastScrollTop = scrollTop;
      });

      // Animaciones de entrada sutiles (fade-in)
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px',
      };

      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('fade-in');
          }
        });
      }, observerOptions);

      // Observar secciones para animaciones
      const sections = document.querySelectorAll('section');
      sections.forEach(section => {
        observer.observe(section);
      });
    });
  </script>
</BaseLayout>
